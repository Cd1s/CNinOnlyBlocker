# ğŸ›¡ï¸ CNinOnlyBlocker äº¤äº’å¢å¼ºç‰ˆ

ğŸš« æ‹’ç»æ‰€æœ‰éä¸­å›½ IP å…¥ç«™è¿æ¥ï½œâœ… ä»…å…è®¸ä¸­å›½ IP å…¥ç«™ï½œğŸŒ æ”¯æŒ IPv4 + IPv6ï½œğŸ¯ è‡ªå®šä¹‰æ”¾è¡Œç«¯å£

è¿™æ˜¯ä¸€ä¸ªå¢å¼ºç‰ˆçš„äº¤äº’å¼ä¸€é”®è„šæœ¬ï¼Œä¸“ä¸ºæœåŠ¡å™¨ç”¨æˆ·è®¾è®¡ï¼ŒåŸºäº `ipset` + `iptables` + `ip6tables`ï¼Œå®ç°**ä»…å…è®¸ä¸­å›½å¤§é™† IP åœ°å€è®¿é—®æœåŠ¡å™¨å…¥ç«™æœåŠ¡**ï¼ŒåŒæ—¶å…è®¸è‡ªå®šä¹‰ç«¯å£æ”¾è¡Œï¼Œæ”¯æŒ IPv6 ç­–ç•¥æ§åˆ¶ï¼Œ**ä¸é™åˆ¶å‡ºç«™è¿æ¥**ï¼Œå¹¶æ”¯æŒ**å¼€æœºè‡ªåŠ¨æ¢å¤é…ç½®**ã€‚

---

## ğŸ“¦ åŠŸèƒ½ç‰¹ç‚¹

- âœ… **ä»…å…è®¸ä¸­å›½ IP å…¥ç«™è¿æ¥ï¼ˆIPv4 / IPv6ï¼‰**
- âŒ **æ‹’ç»æ‰€æœ‰éä¸­å›½ IP å…¥ç«™è¿æ¥**
- ğŸ›ï¸ **æ”¯æŒè‡ªå®šä¹‰æ”¾è¡Œç«¯å£ï¼ˆå›½å†…å¤–éƒ½å¯è®¿é—®ï¼‰**
- ğŸŒ **æ”¯æŒ IPv6 å…¥ç«™é™åˆ¶ï¼ˆå¯é€‰ï¼‰**
- âš¡ ä½¿ç”¨ `ipset` å®ç°é«˜é€ŸåŒ¹é…ï¼Œå¤§è§„æ¨¡ IP è¿‡æ»¤æ— å‹åŠ›
- ğŸ’¾ è‡ªåŠ¨ä¿å­˜é˜²ç«å¢™è§„åˆ™
- ğŸ” å¼€æœºè‡ªåŠ¨è¿˜åŸè§„åˆ™ï¼ˆåŸºäº `systemd` æœåŠ¡ï¼‰
- ğŸ§¹ ä¸€é”®å¸è½½ï¼Œæ¢å¤åŸå§‹é˜²ç«å¢™çŠ¶æ€

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

```bash
curl -O https://raw.githubusercontent.com/Cd1s/CNinOnlyBlocker/refs/heads/main/allow-cn-inbound.sh
chmod +x allow-cn-inbound.sh
sudo ./allow-cn-inbound.sh
```

è¿è¡Œåå¯è¿›å…¥äº¤äº’èœå•ï¼Œæ”¯æŒï¼š

```
1. å®‰è£… IPv4 ä»…ä¸­å›½å…¥ç«™
2. å®‰è£… IPv6 ä»…ä¸­å›½å…¥ç«™ï¼ˆå¯é€‰ï¼‰
3. æŸ¥çœ‹å·²æ”¾è¡Œç«¯å£
4. æ·»åŠ æ”¾è¡Œç«¯å£ï¼ˆæ”¯æŒ TCP / UDPï¼‰
5. åˆ é™¤æ”¾è¡Œç«¯å£
6. å¸è½½ IPv4 è§„åˆ™
7. å¸è½½ IPv6 è§„åˆ™
8. å®Œå…¨å¸è½½å¹¶æ¸…é™¤æ‰€æœ‰è§„åˆ™
```

---

## ğŸ§¯ å¸è½½æ–¹å¼

è‹¥éœ€å®Œå…¨è¿˜åŸæ‰€æœ‰è§„åˆ™å¹¶å¸è½½æœåŠ¡ï¼Œè¯·é€‰æ‹©èœå•ï¼š

```
8. åˆ é™¤å¹¶å¸è½½ï¼Œæ”¾è¡Œå…¨éƒ¨ç«¯å£
```

æˆ–æ‰§è¡Œï¼š

```bash
sudo ./allow-cn-inbound.sh uninstall
```

---

## ğŸ“‚ é…ç½®æ–‡ä»¶è·¯å¾„

| ç±»å‹ | è·¯å¾„ |
|------|------|
| IPv4 ipset | `/etc/ipset/ipset_v4.conf` |
| IPv6 ipset | `/etc/ipset/ipset_v6.conf` |
| IPv4 iptables | `/etc/iptables/rules.v4` |
| IPv6 ip6tables | `/etc/iptables/rules.v6` |
| æ”¾è¡Œç«¯å£åˆ—è¡¨ | `/etc/cnblocker/allowed_ports.conf` |
| systemd æœåŠ¡ | `/etc/systemd/system/ipset-restore.service` |

---

## ğŸ”§ ç³»ç»Ÿè¦æ±‚

- Linux ç³»ç»Ÿï¼ˆå»ºè®® Debian / Ubuntuï¼‰
- Root æƒé™
- è‡ªåŠ¨å®‰è£…ä»¥ä¸‹ä¾èµ–ï¼š
  - `ipset`ã€`iptables`ã€`ip6tables`ã€`curl`ã€`wget`

---

## ğŸ™‹ å¸¸è§é—®é¢˜

> **Qï¼šè¿™ä¸ªè„šæœ¬ä¼šå½±å“æœåŠ¡å™¨ä¸»åŠ¨è®¿é—®å¤–ç½‘å—ï¼Ÿ**  
> Aï¼šä¸ä¼šã€‚æ­¤è„šæœ¬**ä»…é™åˆ¶å…¥ç«™è¿æ¥**ï¼Œ**å‡ºç«™æµé‡ä¸å—å½±å“**ã€‚

> **Qï¼šå¯ä»¥åªé…ç½® IPv4 æˆ– IPv6 å—ï¼Ÿ**  
> Aï¼šå¯ä»¥ï¼Œåˆ†åˆ«åœ¨èœå•ä¸­é€‰æ‹©å³å¯ã€‚

> **Qï¼šæ”¾è¡Œç«¯å£èƒ½ä¿ç•™å—ï¼Ÿ**  
> Aï¼šèƒ½ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨è®°å½•å¹¶åœ¨ä¸‹æ¬¡è¿è¡Œä¸­é‡æ–°åº”ç”¨ã€‚

> **Qï¼šæ•°æ®æºå¯ä»¥æ›´æ¢å—ï¼Ÿ**  
> Aï¼šå¯ä»¥ï¼Œåœ¨è„šæœ¬å†…ä¿®æ”¹ `wget` æˆ– `curl` çš„ä¸‹è½½åœ°å€å³å¯ã€‚

---

## ğŸŒ æ•°æ®æºè¯´æ˜ï¼ˆå·²æ›´æ–°ï¼‰

**IPv4 ä¸»æºï¼š**  
`https://www.ipdeny.com/ipblocks/data/aggregated/cn-aggregated.zone`

**IPv6 ä¸»æºï¼ˆå·²æ›´æ–°ä¸ºï¼‰ï¼š**  
`https://www.ipdeny.com/ipv6/ipaddresses/blocks/cn.zone`

**å¤‡ç”¨æºï¼ˆIPv4/IPv6ï¼‰ï¼š**  
`http://ftp.apnic.net/apnic/stats/apnic/delegated-apnic-latest`

---

å¦‚éœ€è¿›ä¸€æ­¥å®šåˆ¶æˆ–æœ‰å…¶ä»–éœ€æ±‚ï¼Œæ¬¢è¿æå‡ºï¼
